@package lang.oracle

let yield_fut = future

let num_yielded = 0
let yield = func() {
    num_yielded = num_yielded + 1
    wait yield_fut
}
@export yield

spawn func() {
    loop {
        intrinsic oracle_advance_future oracle_advance ()
        wait oracle_advance
        # TODO count the yielded tasks and only break when no more task yielded
        notify yield_fut
        num_yielded = 0
        break
    }
}
